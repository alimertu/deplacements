<!DOCTYPE html>
<html lang ="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title> Outil de Calcul des Émissions de CO2 des déplacements </title>
        <link rel ="stylesheet" href="deplacements.css">
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    </head>

    <body>
        <div class ="container">
            <header>
                <h1>Calcul des Émissions de CO2 liées aux déplacements</h1>
            </header>
            <div id ="form-section">
             

                <form id="formulaire">
                   
                    <section id="informations">
                        <div class="logo-container">
                            <img src="eseo.png" alt="Logo ESEO" class="logo" >
                        </div>
                        <p> Bienvenue sur l'outil de calcul des émissions ges liés aux déplacements.</p>
                        <p> Il est nécessaire d'effectuer un sondage sur les moyens de déplacements avant de remplir ce formulaire(à modifier)</p>
                    </section>


                    <!-- je pense faire deux divs dedans, un div pour déplacement classiques des gens et un autre pour véhicules possédés mais plus tard surement-->
                    <section id="deplacementdt">
                        <h2>Déplacement Domicile Travail</h2>
                        <h3>Déplacement de personnes</h3>
                        <p>Remarque: La règle de remplissage du formulaire est la suivante, si le moyen de déplacement
                            est la voiture , il faudra sélectionner le nombre de voitures et la distance parcourue. Si le moyen de déplacement considéré est
                        le tramway, bus, ou train il faudra considérer la distance et le nombre de personne correspondantes aux différents modes de transport </p>


                        <label for="deplacementdtmode"> Choisissez un mode de déplacement</label>
                        <select id="deplacementdtmode" onchange="updatePeopleNumberLabel()">
                            <option value=""></option>
                            <option value="voitureEssence">Voiture Motorisation Essence</option>
                            <option value="voitureDiesel">Voiture Motorisation Gazole</option>
                            <option value="hybride">Véhicule Hybride(mild Essence)</option>
                            <option value="electrique"> Véhicule électrique</option>
                            <option value="tramway">Tramway</option>
                            <option value="bus">Autobus</option>
                            <option value="marche">Marche</option>
                            <option value="velo">Vélo</option>
                            <option value="train">Train</option>
                        </select>

                        
                    <label for="distancedt">Distance aller-retour Domicile Travail (en km)</label>
                    <input type="number" id="distancedt" min="0">

                   <label for="peopledt" id="peoplenumber"> Nombre de personnes</label>
                   <input type="number" id="peopledt" min="1">
                   
                   <button type="button" onclick="addPeopleTransport()">Ajouter</button>
                   <ul id="people-transport-list"></ul>

                   <h3>Voiture(s) possédée(s) par l'établissement</h3>
                   <p>Veuillez sélectionnez le type de carburant et la quantité en litres</p>

                    <label for="gas">Sélectionner le type de carburant</label>
                    <select id="gas">
                        <option value=""></option>
                        <option value="essence">Essence(E10)</option>
                        <option value="essence1">Essence(E85)</option>
                        <option value="gazole">Gazole</option>
                        <option value="biodiesel">Biodiesel</option>
                        <option value="bioethanol">Bioéthanol</option>
                        <option value="gnl">GNL(Gaz Naturel Liquéfié)</option>
                    </select>

                    <label for="gas-quantity">Quantité en litres</label>
                    <input type="number" id="gas-quantity" min="1" placeholder="en L">

                    <button type="button" onclick="addGas()">Ajouter</button>
                    <ul id="gas-list"></ul>
                    </section>


                    <section id="deplacementsct">
                        <h2>Déplacement dans le cadre du travail</h2>

                        
                        <label for="deplacementctmode"> Choisissez un mode de déplacement</label>
                        <select id="deplacementctmode" onchange="updatePeopleWNumberLabel()">
                            <option value=""></option>
                            <option value="voitureEssence">Voiture Motorisation Essence</option>
                            <option value="voitureDiesel">Voiture Motorisation Gazole</option>
                            <option value="hybride">Véhicule Hybride(mild Essence)</option>
                            <option value="electrique"> Véhicule électrique</option>
                            <option value="tramway">Tramway</option>
                            <option value="bus">Autobus</option>
                            <option value="marche">Marche</option>
                            <option value="velo">Vélo</option>
                            <option value="train">Train</option>
                            <option value="avioncourt">Avion Court-courrier</option>
                            <option value="avionmoyen">Avion Moyen-courrier</option>
                            <option value="avionlong">Avion Long-courrier</option>
                            <option value="avion1court">Avion Court-courrier (par nombre de voyages)</option>
                            <option value="avionmoyen1">Avion Moyen-courrier (par nombre de voyages)</option>
                            <option value="avionlong1">Avion Long-courrier (par nombre de voyages)</option>
                        </select>

                        <label for="distancect">Distance aller-retour Domicile Travail (en km)</label>
                        <input type="number" id="distancect" min="0">
    
                        <label for="peoplect" id="peopleworknumber"> Nombre de personnes</label>
                        <input type="number" id="peoplect" min="1">

                        <button type="button" onclick="addPeopleWTransport()">Ajouter</button>
                        <ul id="peoplework-transport-list"></ul>


                        <h3>Voiture(s) possédée(s) par l'établissement ou trajets remboursés par l'établissement</h3>
                   <p>Veuillez sélectionnez le type de carburant et la quantité en litres</p>

                    <label for="gasw">Sélectionner le type de carburant</label>
                    <select id="gasw">
                        <option value=""></option>
                        <option value="essence">Essence(E10)</option>
                        <option value="essence1">Essence(E85)</option>
                        <option value="gazole">Gazole</option>
                        <option value="biodiesel">Biodiesel</option>
                        <option value="bioethanol">Bioéthanol</option>
                        <option value="gnl">GNL(Gaz Naturel Liquéfié)</option>
                    </select>

                    <label for="gasw-quantity">Quantité en litres</label>
                    <input type="number" id="gasw-quantity" min="1" placeholder="en L">

                    <button type="button" onclick="addGasW()">Ajouter</button>
                    <ul id="gasw-list"></ul>
                    </section>

                    


                    

                    <section id="deplacementi">
                        <h2>Déplacement d'invités</h2>

                        <label for="deplacementimode"> Choisissez un mode de déplacement</label>
                        <select id="deplacementimode" onchange="updatePeopleINumberLabel()">
                            <option value=""></option>
                            <option value="voitureEssence">Voiture Motorisation Essence</option>
                            <option value="voitureDiesel">Voiture Motorisation Gazole</option>
                            <option value="hybride">Véhicule Hybride(mild Essence)</option>
                            <option value="electrique"> Véhicule électrique</option>
                            <option value="tramway">Tramway</option>
                            <option value="bus">Autobus</option>
                            <option value="marche">Marche</option>
                            <option value="velo">Vélo</option>
                            <option value="train">Train</option>
                            <option value="avioncourt">Avion Court-courrier</option>
                            <option value="avionmoyen">Avion Moyen-courrier</option>
                            <option value="avionlong">Avion Long-courrier</option>
                            <option value="avion1court">Avion Court-courrier (par nombre de voyages)</option>
                            <option value="avionmoyen1">Avion Moyen-courrier (par nombre de voyages)</option>
                            <option value="avionlong1">Avion Long-courrier (par nombre de voyages)</option>
                        </select>

                        <label for="distancei">Distance aller-retour Domicile Travail (en km)</label>
                        <input type="number" id="distancei" min="0">
    
                        <label for="peoplei" id="peopleinvitenumber"> Nombre de personnes</label>
                        <input type="number" id="peoplei" min="1">

                        <button type="button" onclick="addPeopleITransport()">Ajouter</button>
                        <ul id="peopleinvite-transport-list"></ul>


                        <h3>Trajets de consommation  remboursés à la consommation de carburant</h3>
                   <p>Veuillez sélectionnez le type de carburant et la quantité en litres</p>

                    <label for="gasi">Sélectionner le type de carburant</label>
                    <select id="gasi">
                        <option value=""></option>
                        <option value="essence">Essence(E10)</option>
                        <option value="essence1">Essence(E85)</option>
                        <option value="gazole">Gazole</option>
                        <option value="biodiesel">Biodiesel</option>
                        <option value="bioethanol">Bioéthanol</option>
                        <option value="gnl">GNL(Gaz Naturel Liquéfié)</option>
                    </select>

                    <label for="gasi-quantity">Quantité en litres</label>
                    <input type="number" id="gasi-quantity" min="1" placeholder="en L">

                    <button type="button" onclick="addGasI()">Ajouter</button>
                    <ul id="gasi-list"></ul>
                    </section>

                    <section>
                        <button type="button" onclick="calculateCO2()">Calculer</button>
                        <button type="button">rafraichir</button>
                    </section>























                </form>
            </div>

            <!-- Section Résultats-->
             <div id ="result-section">
                <h1>Résulats</h1>
                <div id="result"></div>
                <div class="chart-container">
                    <h2> Répartition des émissions de CO2</h2>
                    <canvas id="co2" width="350" height="400"></canvas>
                 </div>
                 <button type="button" onclick="exportExcel()">Exporter en Excel</button>
                 <button type="button" onclick="goBack()">Revenir au formulaire</button>
             </div>
             

        </div>

        <script src="deplacement.js"></script>
    </body>
</html>